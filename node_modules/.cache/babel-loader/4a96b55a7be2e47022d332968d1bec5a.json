{"remainingRequest":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\src\\module-manage\\components\\permissions-add.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\src\\module-manage\\components\\permissions-add.vue","mtime":1666099292789},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\babel.config.js","mtime":1665578302209},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662199701179},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\babel-loader\\lib\\index.js","mtime":1661140982816},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662199701179},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\vue-loader\\lib\\index.js","mtime":1662199723728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGRldGFpbCwgdXBkYXRlLCBhZGQgfSBmcm9tICdAL2FwaS9iYXNlL3Blcm1pc3Npb25zJzsKaW1wb3J0IHsgbGlzdCB9IGZyb20gJ0AvYXBpL2Jhc2UvbWVudXMuanMnOwpsZXQgX3RoaXMgPSBbXTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdwZXJtaXNzaW9uc0FkZCcsCiAgcHJvcHM6IFsnZGlhbG9nRm9ybVZpc2libGUnLCAndGV4dCcsICdwYWdlVGl0bGUnLCAnb2JqZWRpdElkJ10sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IFtdLAogICAgICBQZXJtaXNzaW9uR3JvdXBzbWVudTogW10sCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGxhYmVsOiAndGl0bGUnCiAgICAgIH0sCiAgICAgIHBlcm1pc3Npb25zOiBbXSwKICAgICAgdHJlZUNoZWNrZWROb2RlczogW10sCiAgICAgIGZvcm1CYXNlOiB7CiAgICAgICAgaWQ6IDAsCiAgICAgICAgY3JlYXRlX2RhdGU6ICcnLAogICAgICAgIHRpdGxlOiAnJywKICAgICAgICBwZXJtaXNzaW9uczogW10KICAgICAgfSwKICAgICAgY3VyUGVybWlzc2lvbnM6IFtdLAogICAgICBydWxlczogewogICAgICAgIHRpdGxlOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn5b+F5aGrJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dCiAgICAgIH0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdHJlZURhdGEoKSB7CiAgICAgIGZ1bmN0aW9uIGNyZWF0ZU5vZGUoaXRlbSkgewogICAgICAgIHZhciBfdGhpcyRmb3JtQmFzZSRwZXJtaXM7CiAgICAgICAgLy8g5aSN6YCJ5qGG6YCJ5oupCiAgICAgICAgbGV0IGNoZWNrZWQgPSBmYWxzZTsKICAgICAgICBsZXQgc2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgICBpZiAoX3RoaXMgIT09IG51bGwgJiYgKChfdGhpcyRmb3JtQmFzZSRwZXJtaXMgPSBfdGhpcy5mb3JtQmFzZS5wZXJtaXNzaW9ucykgPT09IG51bGwgfHwgX3RoaXMkZm9ybUJhc2UkcGVybWlzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRmb3JtQmFzZSRwZXJtaXMubGVuZ3RoKSA+IDApIHsKICAgICAgICAgIGNvbnN0IHBlciA9IF90aGlzLmZvcm1CYXNlLnBlcm1pc3Npb25zLmZpbmQoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT09IGl0ZW0uaWQ7CiAgICAgICAgICB9KTsKICAgICAgICAgIHNlbGVjdGVkID0gISFwZXI7CiAgICAgICAgfQogICAgICAgIC8vIOagh+iusOWLvumAiQogICAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgICAgY29uc3QgaXNQb2ludCA9IGl0ZW0uY2hpbGRzID09PSB1bmRlZmluZWQgJiYgaXRlbS5wb2ludHMgPT09IHVuZGVmaW5lZDsKICAgICAgICAgIGNvbnN0IGhhc0NoaWxkcyA9IGl0ZW0uY2hpbGRzICE9PSB1bmRlZmluZWQgJiYgaXRlbS5jaGlsZHMubGVuZ3RoID4gMDsKICAgICAgICAgIGNvbnN0IGhhc1BvaW50cyA9IGl0ZW0ucG9pbnRzICE9PSB1bmRlZmluZWQgJiYgaXRlbS5wb2ludHMubGVuZ3RoID4gMDsKICAgICAgICAgIGlmIChpc1BvaW50KSB7CiAgICAgICAgICAgIGNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIGlmIChoYXNQb2ludHMpIHsKICAgICAgICAgICAgY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIGlmIChoYXNDaGlsZHMpIHsKICAgICAgICAgICAgY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB7CiAgICAgICAgICBpZDogaXRlbS5pZCA9PT0gdW5kZWZpbmVkID8gMCA6IGl0ZW0uaWQsCiAgICAgICAgICB0aXRsZTogaXRlbS50aXRsZSwKICAgICAgICAgIGNoaWxkcmVuOiBbXSwKICAgICAgICAgIHNlbGVjdGVkOiBzZWxlY3RlZCwKICAgICAgICAgIGNoZWNrZWQ6IGNoZWNrZWQKICAgICAgICB9OwogICAgICB9CiAgICAgIGZ1bmN0aW9uIHBhcnNlTm9kZXMobm9kZXMsIHBhcmVudE5vZGUpIHsKICAgICAgICBmb3IgKGNvbnN0IGl0IG9mIG5vZGVzKSB7CiAgICAgICAgICB2YXIgX2l0JGNoaWxkcywgX2l0JHBvaW50czsKICAgICAgICAgIGNvbnN0IG5vZGUgPSBjcmVhdGVOb2RlKGl0KTsKICAgICAgICAgIC8vIOagh+iusOmAieS4rQogICAgICAgICAgLy8gY29uc29sZS5sb2cobm9kZS5jaGVja2VkKQogICAgICAgICAgaWYgKG5vZGUuY2hlY2tlZCkgewogICAgICAgICAgICBwYXJlbnROb2RlLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChpdC5jaGlsZHMgIT09IHVuZGVmaW5lZCAmJiAoKF9pdCRjaGlsZHMgPSBpdC5jaGlsZHMpID09PSBudWxsIHx8IF9pdCRjaGlsZHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pdCRjaGlsZHMubGVuZ3RoKSA+IDApIHsKICAgICAgICAgICAgcGFyc2VOb2RlcyhpdC5jaGlsZHMsIG5vZGUpOwogICAgICAgICAgfSBlbHNlIGlmIChpdC5wb2ludHMgIT09IHVuZGVmaW5lZCAmJiAoKF9pdCRwb2ludHMgPSBpdC5wb2ludHMpID09PSBudWxsIHx8IF9pdCRwb2ludHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pdCRwb2ludHMubGVuZ3RoKSA+IDApIHsKICAgICAgICAgICAgcGFyc2VOb2RlcyhpdC5wb2ludHMsIG5vZGUpOwogICAgICAgICAgfQogICAgICAgICAgcGFyZW50Tm9kZS5jaGlsZHJlbi5wdXNoKG5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBub2RlcyA9IGNyZWF0ZU5vZGUoewogICAgICAgIHRpdGxlOiAn57O757uf6I+c5Y2V5ZKM6aG16Z2i5p2D6ZmQ54K5JywKICAgICAgICBleHBhbmQ6IHRydWUKICAgICAgfSk7CiAgICAgIHBhcnNlTm9kZXModGhpcy5QZXJtaXNzaW9uR3JvdXBzbWVudSwgbm9kZXMpOwogICAgICByZXR1cm4gW25vZGVzXTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOmAgOWHugogICAgaGFuZGxlQ2xvc2UoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZTpkaWFsb2dGb3JtVmlzaWJsZScsIGZhbHNlKTsKICAgICAgdGhpcy4kcmVmcy5kYXRhRm9ybS5yZXNldEZpZWxkcygpOwogICAgICAvLyDooajljZXph43nva4KICAgICAgdGhpcy5mb3JtQmFzZSA9IHsKICAgICAgICBpZDogMCwKICAgICAgICB0aXRsZTogJycsCiAgICAgICAgcGVybWlzc2lvbnM6IFtdCiAgICAgIH07CiAgICB9LAogICAgLy8g57yW6L6R6K+m5oOF5pWw5o2u5Yqg6L29CiAgICBhc3luYyBoYW5sZGVFZGl0Rm9ybSgpIHsKICAgICAgdGhpcy5mb3JtQmFzZS5pZCA9IHRoaXMub2JqZWRpdElkOwogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICBpZDogdGhpcy5vYmplZGl0SWQKICAgICAgfTsKICAgICAgY29uc3QgcmV0ID0gYXdhaXQgZGV0YWlsKGRhdGEpOwogICAgICBjb25zb2xlLmxvZyhyZXQsIDY2Nik7CiAgICAgIHRoaXMuZm9ybUJhc2UuaWQgPSByZXQuZGF0YS5pZDsKICAgICAgdGhpcy5mb3JtQmFzZS50aXRsZSA9IHJldC5kYXRhLnRpdGxlOwogICAgICB0aGlzLmZvcm1CYXNlLnBlcm1pc3Npb25zID0gcmV0LmRhdGEucGVybWlzc2lvbnM7CiAgICB9LAogICAgYXN5bmMgc2V0dXBEYXRhKCkgewogICAgICAvLyBkYXRh5piv5oiQ5Yqf5pe26L+U5Zue55qE5pWw5o2uCiAgICAgIC8vIGxpc3QoKS50aGVuKGRhdGEgPT4gewogICAgICAvLyAgIHRoaXMuUGVybWlzc2lvbkdyb3Vwc21lbnUgPSBkYXRhLmRhdGEKICAgICAgLy8gfSkKICAgICAgY29uc3QgewogICAgICAgIGRhdGEKICAgICAgfSA9IGF3YWl0IGxpc3QoKTsKICAgICAgdGhpcy5QZXJtaXNzaW9uR3JvdXBzbWVudSA9IGRhdGE7CiAgICB9LAogICAgLy8g6IqC54K55aSN6YCJ5qGG6KKr6YCJ5LitCiAgICBoYW5kbGVDaGVja0NoYW5nZShkYXRhLCBjaGVja2VkLCBpbmRldGVybWluYXRlKSB7CiAgICAgIHRoaXMudHJlZUNoZWNrZWROb2RlcyA9IGNoZWNrZWQuY2hlY2tlZE5vZGVzOwogICAgICB0aGlzLmxpc3QgPSB0aGlzLnRyZWVDaGVja2VkTm9kZXM7CiAgICAgIHRoaXMuZm9ybUJhc2UucGVybWlzc2lvbnMgPSB0aGlzLmxpc3QubWFwKGl0ZW0gPT4gewogICAgICAgIHJldHVybiBpdGVtLmlkOwogICAgICB9KTsKICAgICAgLy8gY29uc29sZS5sb2coNjkzLCB0aGlzLmZvcm1CYXNlLnBlcm1pc3Npb25zKQogICAgfSwKCiAgICAvLyDooajljZXmj5DkuqQKICAgIGFzeW5jIGhhbmRsZUFkZChvYmplY3QpIHsKICAgICAgdmFyIF90aGlzJHRyZWVDaGVja2VkTm9kZTsKICAgICAgLy8g6K+75Y+W5a6M5pW06IqC54K5CiAgICAgIGNvbnN0IGN1clBlcm1pc3Npb25zID0gbmV3IFNldCgpOwogICAgICBjb25zb2xlLmxvZyhjdXJQZXJtaXNzaW9ucyk7CiAgICAgIC8vIOW3sumAieS4reeahOaOp+S7tuiKgueCuQogICAgICBpZiAoKChfdGhpcyR0cmVlQ2hlY2tlZE5vZGUgPSB0aGlzLnRyZWVDaGVja2VkTm9kZXMpID09PSBudWxsIHx8IF90aGlzJHRyZWVDaGVja2VkTm9kZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkdHJlZUNoZWNrZWROb2RlLmxlbmd0aCkgPT09IDApIHsKICAgICAgICB2YXIgX3RoaXMkdHJlZUNoZWNrZWROb2RlMjsKICAgICAgICB0aGlzLnRyZWVDaGVja2VkTm9kZXMgPSB0aGlzLiRyZWZzLnRyZWVNZW51LmdldENoZWNrZWROb2RlcygpOwogICAgICAgIGlmICgoKF90aGlzJHRyZWVDaGVja2VkTm9kZTIgPSB0aGlzLnRyZWVDaGVja2VkTm9kZXMpID09PSBudWxsIHx8IF90aGlzJHRyZWVDaGVja2VkTm9kZTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHRyZWVDaGVja2VkTm9kZTIubGVuZ3RoKSA9PT0gMCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyDor7vlj5YKICAgICAgZm9yIChjb25zdCBpdCBvZiB0aGlzLnRyZWVDaGVja2VkTm9kZXMpIHsKICAgICAgICAvLyBwYXJzZSh0aGlzLlBlcm1pc3Npb25Hcm91cHNtZW51LCBpdC5pZCkKICAgICAgICBjdXJQZXJtaXNzaW9ucy5hZGQoaXQuaWQpOwogICAgICB9CiAgICAgIHRoaXMuY3VyUGVybWlzc2lvbnMgPSBBcnJheS5mcm9tKGN1clBlcm1pc3Npb25zKTsKICAgICAgLy8g5L+d5a2YCiAgICAgIGlmICh0aGlzLmN1clBlcm1pc3Npb25zLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqemcgOimgeeahOadg+mZkOWPiumhtemdouadg+mZkOeCuScsCiAgICAgICAgICB0eXBlOiAnZXJyb3InCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgb2JqZWRpdElkID8gYXdhaXQgdXBkYXRlKHRoaXMuZm9ybUJhc2UpIDogYXdhaXQgYWRkKHRoaXMuZm9ybUJhc2UpOwogICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+aWsOWinuaIkOWKnycpOwogICAgICB0aGlzLiRwYXJlbnQuZ2V0UGVybWlzc2lvbnNMaXN0KCk7CiAgICAgIHRoaXMuaGFuZGxlQ2xvc2UoKTsKICAgIH0sCiAgICBub2RlRGF0ZShub2Rlc1BhdGgsIGN1clBlcm1pc3Npb25zLCBmaW5kSWQpIHsKICAgICAgbm9kZXNQYXRoLm1hcChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICBpZiAoY3VyUGVybWlzc2lvbnMuaW5kZXhPZihpdGVtLmlkKSA9PT0gLTEpIHsKICAgICAgICAgIGN1clBlcm1pc3Npb25zLnB1c2goZmluZElkKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgLy8g5oyC6L2957uT5p2fCgogIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHt9LAogIC8vIOWIm+W7uuWujOavleeKtuaAgQogIGNyZWF0ZWQoKSB7CiAgICBfdGhpcyA9IHRoaXM7CiAgICB0aGlzLnNldHVwRGF0YSgpOwogIH0sCiAgLy8g57uE5Lu25pu05pawCiAgdXBkYXRlZDogZnVuY3Rpb24gKCkge30KfTs="},{"version":3,"mappings":";AAyCA;AACA;AACA;AACA;EACAA;EACAC;EACAC;IACA;MACAC;MACAC;MACAC;QACAC;MACA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAL;MACA;MACAM;MACAC;QACAF,QACA;UAAAG;UAAAC;UAAAC;QAAA;MAEA;IACA;EACA;EACAC;IACAC;MACA;QAAA;QACA;QACA;QACA;QACA;UACA;YACA;UACA;UACAC;QACA;QACA;QACA;UACA;UACA;UACA;UACA;YACAC;UACA;YACAA;UACA;YACAA;UACA;YACAA;UACA;QACA;QACA;UACAX;UACAE;UACAU;UACAF;UACAC;QACA;MACA;MACA;QACA;UAAA;UACA;UACA;UACA;UACA;YACAE;UACA;UACA;YACAC;UACA;YACAA;UACA;UACAD;QACA;MACA;MACA;QAAAX;QAAAa;MAAA;MACAD;MACA;IACA;EACA;EACAE;IACA;IACAC;MACA;MACA;MACA;MACA;QACAjB;QACAE;QACAL;MACA;IACA;IACA;IACA;MACA;MACA;QACAG;MACA;MACA;MACAkB;MACA;MACA;MACA;IACA;IACA;MACA;MACA;MACA;MACA;MACA;QAAA1B;MAAA;MACA;IACA;IAEA;IACA2B;MACA;MACA;MACA;QACA;MACA;MACA;IACA;;IAEA;IACA;MAAA;MACA;MACA;MACAD;MACA;MACA;QAAA;QACA;QACA;UACA;QACA;MACA;MACA;MACA;QACA;QACAf;MACA;MACA;MACA;MACA;QACA;UACAiB;UACAd;UACAe;QACA;MACA;MACAC;MACA;MACA;MACA;IACA;IACAC;MACAC;QACA;UACArB;QACA;MACA;IACA;EACA;EACA;;EAEAsB;EACA;EACAC;IACAC;IACA;EACA;EACA;EACAC;AACA","names":["name","props","data","list","PermissionGroupsmenu","defaultProps","label","permissions","treeCheckedNodes","formBase","id","create_date","title","curPermissions","rules","required","message","trigger","computed","treeData","selected","checked","children","parentNode","parseNodes","expand","methods","handleClose","console","handleCheckChange","showClose","type","objeditId","nodeDate","nodesPath","mounted","created","_this","updated"],"sourceRoot":"src/module-manage/components","sources":["permissions-add.vue"],"sourcesContent":["<template>\r\n  <div class=\"add-form\">\r\n    <el-dialog\r\n      :title=\"objeditId ? '编辑权限组' : '创建权限组'\"\r\n      :visible=\"dialogFormVisible\"\r\n      @close=\"handleClose\"\r\n    >\r\n      <el-form\r\n        :rules=\"rules\"\r\n        ref=\"dataForm\"\r\n        :model=\"formBase\"\r\n        label-position=\"left\"\r\n        label-width=\"120px\"\r\n        style=\"width: 400px; margin-left: 120px\"\r\n      >\r\n        <el-form-item :label=\"$t('table.username')\" prop=\"title\">\r\n          <el-input v-model=\"formBase.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item :label=\"$t('table.powerDistriB')\">\r\n          <el-tree\r\n            ref=\"treeMenu\"\r\n            :data=\"treeData\"\r\n            show-checkbox\r\n            node-key=\"id\"\r\n            :default-expanded-keys=\"[0]\"\r\n            :default-checked-keys=\"formBase.permissions\"\r\n            :props=\"defaultProps\"\r\n            @check=\"handleCheckChange\"\r\n          ></el-tree>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"handleClose\">{{ $t('table.cancel') }}</el-button>\r\n        <el-button type=\"primary\" @click=\"handleAdd('formBase')\">{{\r\n          $t('table.confirm')\r\n        }}</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { detail, update, add } from '@/api/base/permissions'\r\nimport { list } from '@/api/base/menus.js'\r\nlet _this = []\r\nexport default {\r\n  name: 'permissionsAdd',\r\n  props: ['dialogFormVisible', 'text', 'pageTitle', 'objeditId'],\r\n  data () {\r\n    return {\r\n      list: [],\r\n      PermissionGroupsmenu: [],\r\n      defaultProps: {\r\n        label: 'title'\r\n      },\r\n      permissions: [],\r\n      treeCheckedNodes: [],\r\n      formBase: {\r\n        id: 0,\r\n        create_date: '',\r\n        title: '',\r\n        permissions: []\r\n      },\r\n      curPermissions: [],\r\n      rules: {\r\n        title: [\r\n          { required: true, message: '必填', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    treeData () {\r\n      function createNode (item) {\r\n        // 复选框选择\r\n        let checked = false\r\n        let selected = false\r\n        if (_this !== null && _this.formBase.permissions?.length > 0) {\r\n          const per = _this.formBase.permissions.find(function (value, index) {\r\n            return value === item.id\r\n          })\r\n          selected = !!per\r\n        }\r\n        // 标记勾选\r\n        if (selected) {\r\n          const isPoint = item.childs === undefined && item.points === undefined\r\n          const hasChilds = item.childs !== undefined && item.childs.length > 0\r\n          const hasPoints = item.points !== undefined && item.points.length > 0\r\n          if (isPoint) {\r\n            checked = true\r\n          } else if (hasPoints) {\r\n            checked = false\r\n          } else if (hasChilds) {\r\n            checked = false\r\n          } else {\r\n            checked = true\r\n          }\r\n        }\r\n        return {\r\n          id: item.id === undefined ? 0 : item.id,\r\n          title: item.title,\r\n          children: [],\r\n          selected: selected,\r\n          checked: checked\r\n        }\r\n      }\r\n      function parseNodes (nodes, parentNode) {\r\n        for (const it of nodes) {\r\n          const node = createNode(it)\r\n          // 标记选中\r\n          // console.log(node.checked)\r\n          if (node.checked) {\r\n            parentNode.selected = true\r\n          }\r\n          if (it.childs !== undefined && it.childs?.length > 0) {\r\n            parseNodes(it.childs, node)\r\n          } else if (it.points !== undefined && it.points?.length > 0) {\r\n            parseNodes(it.points, node)\r\n          }\r\n          parentNode.children.push(node)\r\n        }\r\n      }\r\n      const nodes = createNode({ title: '系统菜单和页面权限点', expand: true })\r\n      parseNodes(this.PermissionGroupsmenu, nodes)\r\n      return [nodes]\r\n    }\r\n  },\r\n  methods: {\r\n    // 退出\r\n    handleClose () {\r\n      this.$emit('update:dialogFormVisible', false)\r\n      this.$refs.dataForm.resetFields()\r\n      // 表单重置\r\n      this.formBase = {\r\n        id: 0,\r\n        title: '',\r\n        permissions: []\r\n      }\r\n    },\r\n    // 编辑详情数据加载\r\n    async hanldeEditForm () {\r\n      this.formBase.id = this.objeditId\r\n      var data = {\r\n        id: this.objeditId\r\n      }\r\n      const ret = await detail(data)\r\n      console.log(ret, 666)\r\n      this.formBase.id = ret.data.id\r\n      this.formBase.title = ret.data.title\r\n      this.formBase.permissions = ret.data.permissions\r\n    },\r\n    async setupData () {\r\n      // data是成功时返回的数据\r\n      // list().then(data => {\r\n      //   this.PermissionGroupsmenu = data.data\r\n      // })\r\n      const { data } = await list()\r\n      this.PermissionGroupsmenu = data\r\n    },\r\n\r\n    // 节点复选框被选中\r\n    handleCheckChange (data, checked, indeterminate) {\r\n      this.treeCheckedNodes = checked.checkedNodes\r\n      this.list = this.treeCheckedNodes\r\n      this.formBase.permissions = this.list.map(item => {\r\n        return item.id\r\n      })\r\n      // console.log(693, this.formBase.permissions)\r\n    },\r\n\r\n    // 表单提交\r\n    async handleAdd (object) {\r\n      // 读取完整节点\r\n      const curPermissions = new Set()\r\n      console.log(curPermissions)\r\n      // 已选中的控件节点\r\n      if (this.treeCheckedNodes?.length === 0) {\r\n        this.treeCheckedNodes = this.$refs.treeMenu.getCheckedNodes()\r\n        if (this.treeCheckedNodes?.length === 0) {\r\n          return\r\n        }\r\n      }\r\n      // 读取\r\n      for (const it of this.treeCheckedNodes) {\r\n        // parse(this.PermissionGroupsmenu, it.id)\r\n        curPermissions.add(it.id)\r\n      }\r\n      this.curPermissions = Array.from(curPermissions)\r\n      // 保存\r\n      if (this.curPermissions.length === 0) {\r\n        this.$message({\r\n          showClose: true,\r\n          message: '请选择需要的权限及页面权限点',\r\n          type: 'error'\r\n        })\r\n      }\r\n      objeditId ? await update(this.formBase) : await add(this.formBase)\r\n      this.$message.success('新增成功')\r\n      this.$parent.getPermissionsList()\r\n      this.handleClose()\r\n    },\r\n    nodeDate (nodesPath, curPermissions, findId) {\r\n      nodesPath.map(function (item, index) {\r\n        if (curPermissions.indexOf(item.id) === -1) {\r\n          curPermissions.push(findId)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  // 挂载结束\r\n\r\n  mounted: function () { },\r\n  // 创建完毕状态\r\n  created () {\r\n    _this = this\r\n    this.setupData()\r\n  },\r\n  // 组件更新\r\n  updated: function () { }\r\n}\r\n</script>\r\n<style>\r\n.el-tree {\r\n  margin-top: 8px;\r\n}\r\n.el-tree-node__content {\r\n  height: auto;\r\n}\r\n.el-form--label-left .el-form-item__label {\r\n  text-align: right;\r\n}\r\n.el-dialog__footer {\r\n  text-align: right;\r\n}\r\n</style>\r\n"]}]}