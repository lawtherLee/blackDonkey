{"remainingRequest":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\src\\module-manage\\components\\permissions-add.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\src\\module-manage\\components\\permissions-add.vue","mtime":1665578302330},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662199701179},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\babel-loader\\lib\\index.js","mtime":1661140982816},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1662199701179},{"path":"C:\\Users\\辛虞\\Desktop\\脚手架vue项目\\blackDonkey\\node_modules\\vue-loader\\lib\\index.js","mtime":1662199723728}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBkZXRhaWwsIHVwZGF0ZSwgYWRkIH0gZnJvbSAnQC9hcGkvYmFzZS9wZXJtaXNzaW9ucycNCmltcG9ydCB7IGxpc3QgfSBmcm9tICdAL2FwaS9iYXNlL21lbnVzLmpzJw0KbGV0IF90aGlzID0gW10NCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ3VzZXJzQWRkJywNCiAgcHJvcHM6IFsndGV4dCcsICdwYWdlVGl0bGUnLCAncnVsZUlubGluZSddLA0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLA0KICAgICAgUGVybWlzc2lvbkdyb3Vwc21lbnU6IFtdLA0KICAgICAgZGVmYXVsdFByb3BzOiB7DQogICAgICAgIGxhYmVsOiAndGl0bGUnDQogICAgICB9LA0KICAgICAgcGVybWlzc2lvbnM6IFtdLA0KICAgICAgdHJlZUNoZWNrZWROb2RlczogW10sDQogICAgICBmb3JtQmFzZTogew0KICAgICAgICBpZDogMCwNCiAgICAgICAgY3JlYXRlX2RhdGU6ICcnLA0KICAgICAgICB0aXRsZTogJycsDQogICAgICAgIHBlcm1pc3Npb25zOiBbXQ0KICAgICAgfSwNCiAgICAgIGN1clBlcm1pc3Npb25zOiBbXQ0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICB0cmVlRGF0YSAoKSB7DQogICAgICBmdW5jdGlvbiBjcmVhdGVOb2RlIChpdGVtKSB7DQogICAgICAgIC8vIOWkjemAieahhumAieaLqQ0KICAgICAgICBsZXQgY2hlY2tlZCA9IGZhbHNlDQogICAgICAgIGxldCBzZWxlY3RlZCA9IGZhbHNlDQogICAgICAgIGlmIChfdGhpcyAhPT0gbnVsbCAmJiBfdGhpcy5mb3JtQmFzZS5wZXJtaXNzaW9ucy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgY29uc3QgcGVyID0gX3RoaXMuZm9ybUJhc2UucGVybWlzc2lvbnMuZmluZChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7DQogICAgICAgICAgICByZXR1cm4gdmFsdWUgPT09IGl0ZW0uaWQNCiAgICAgICAgICB9KQ0KICAgICAgICAgIHNlbGVjdGVkID0gISFwZXINCiAgICAgICAgfQ0KICAgICAgICAvLyDmoIforrDli77pgIkNCiAgICAgICAgaWYgKHNlbGVjdGVkKSB7DQogICAgICAgICAgY29uc3QgaXNQb2ludCA9IGl0ZW0uY2hpbGRzID09PSB1bmRlZmluZWQgJiYgaXRlbS5wb2ludHMgPT09IHVuZGVmaW5lZA0KICAgICAgICAgIGNvbnN0IGhhc0NoaWxkcyA9IGl0ZW0uY2hpbGRzICE9PSB1bmRlZmluZWQgJiYgaXRlbS5jaGlsZHMubGVuZ3RoID4gMA0KICAgICAgICAgIGNvbnN0IGhhc1BvaW50cyA9IGl0ZW0ucG9pbnRzICE9PSB1bmRlZmluZWQgJiYgaXRlbS5wb2ludHMubGVuZ3RoID4gMA0KICAgICAgICAgIGlmIChpc1BvaW50KSB7DQogICAgICAgICAgICBjaGVja2VkID0gdHJ1ZQ0KICAgICAgICAgIH0gZWxzZSBpZiAoaGFzUG9pbnRzKSB7DQogICAgICAgICAgICBjaGVja2VkID0gZmFsc2UNCiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NoaWxkcykgew0KICAgICAgICAgICAgY2hlY2tlZCA9IGZhbHNlDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGNoZWNrZWQgPSB0cnVlDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgaWQ6IGl0ZW0uaWQgPT09IHVuZGVmaW5lZCA/IDAgOiBpdGVtLmlkLA0KICAgICAgICAgIHRpdGxlOiBpdGVtLnRpdGxlLA0KICAgICAgICAgIGNoaWxkcmVuOiBbXSwNCiAgICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWQsDQogICAgICAgICAgY2hlY2tlZDogY2hlY2tlZA0KICAgICAgICB9DQogICAgICB9DQogICAgICBmdW5jdGlvbiBwYXJzZU5vZGVzIChub2RlcywgcGFyZW50Tm9kZSkgew0KICAgICAgICBmb3IgKGNvbnN0IGl0IG9mIG5vZGVzKSB7DQogICAgICAgICAgY29uc3Qgbm9kZSA9IGNyZWF0ZU5vZGUoaXQpDQogICAgICAgICAgLy8g5qCH6K6w6YCJ5LitDQogICAgICAgICAgLy8gY29uc29sZS5sb2cobm9kZS5jaGVja2VkKQ0KICAgICAgICAgIGlmIChub2RlLmNoZWNrZWQpIHsNCiAgICAgICAgICAgIHBhcmVudE5vZGUuc2VsZWN0ZWQgPSB0cnVlDQogICAgICAgICAgfQ0KICAgICAgICAgIGlmIChpdC5jaGlsZHMgIT09IHVuZGVmaW5lZCAmJiBpdC5jaGlsZHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgcGFyc2VOb2RlcyhpdC5jaGlsZHMsIG5vZGUpDQogICAgICAgICAgfSBlbHNlIGlmIChpdC5wb2ludHMgIT09IHVuZGVmaW5lZCAmJiBpdC5wb2ludHMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgcGFyc2VOb2RlcyhpdC5wb2ludHMsIG5vZGUpDQogICAgICAgICAgfQ0KICAgICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW4ucHVzaChub2RlKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBjb25zdCBub2RlcyA9IGNyZWF0ZU5vZGUoeyB0aXRsZTogJ+ezu+e7n+iPnOWNleWSjOmhtemdouadg+mZkOeCuScsIGV4cGFuZDogdHJ1ZSB9KQ0KICAgICAgcGFyc2VOb2Rlcyh0aGlzLlBlcm1pc3Npb25Hcm91cHNtZW51LCBub2RlcykNCiAgICAgIHJldHVybiBbbm9kZXNdDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5by55bGC5pi+56S6DQogICAgZGlhbG9nRm9ybVYgKCkgew0KICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWUNCiAgICB9LA0KICAgIC8vIOW8ueWxgumakOiXjw0KICAgIGRpYWxvZ0Zvcm1IICgpIHsNCiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQ0KICAgIH0sDQogICAgLy8g6YCA5Ye6DQogICAgaGFuZGxlQ2xvc2UgKCkgew0KICAgICAgdGhpcy4kZW1pdCgnaGFuZGxlQ2xvc2VNb2RhbCcpDQogICAgfSwNCiAgICAvLyDooajljZXph43nva4NCiAgICBoYW5kbGVSZXNldEZvcm0gKCkgew0KICAgICAgdGhpcy5mb3JtQmFzZSA9IHsNCiAgICAgICAgaWQ6IDAsDQogICAgICAgIHRpdGxlOiAnJywNCiAgICAgICAgcGVybWlzc2lvbnM6IFtdDQogICAgICB9DQogICAgfSwNCiAgICAvLyDnvJbovpHor6bmg4XmlbDmja7liqDovb0NCiAgICBoYW5sZGVFZGl0Rm9ybSAob2JqZWRpdElkKSB7DQogICAgICB0aGlzLmZvcm1CYXNlLmlkID0gb2JqZWRpdElkDQogICAgICB2YXIgZGF0YSA9IHsNCiAgICAgICAgaWQ6IG9iamVkaXRJZA0KICAgICAgfQ0KICAgICAgZGV0YWlsKGRhdGEpLnRoZW4oKHJldCwgZXJyKSA9PiB7DQogICAgICAgIGlmIChlcnIpIHsNCiAgICAgICAgICByZXR1cm4gZXJyDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5mb3JtQmFzZS5pZCA9IHJldC5kYXRhLmlkDQogICAgICAgIHRoaXMuZm9ybUJhc2UudGl0bGUgPSByZXQuZGF0YS50aXRsZQ0KICAgICAgICB0aGlzLmZvcm1CYXNlLnBlcm1pc3Npb25zID0gcmV0LmRhdGEucGVybWlzc2lvbnMNCiAgICAgIH0pDQogICAgfSwNCiAgICBzZXR1cERhdGEgKCkgew0KICAgICAgbGlzdCgpLnRoZW4oZGF0YSA9PiB7DQogICAgICAgIHRoaXMuUGVybWlzc2lvbkdyb3Vwc21lbnUgPSBkYXRhLmRhdGENCiAgICAgIH0pDQogICAgfSwNCg0KICAgIC8vIOiKgueCueWkjemAieahhuiiq+mAieS4rQ0KICAgIGhhbmRsZUNoZWNrQ2hhbmdlIChkYXRhLCBjaGVja2VkLCBpbmRldGVybWluYXRlKSB7DQogICAgICB0aGlzLnRyZWVDaGVja2VkTm9kZXMgPSBjaGVja2VkLmNoZWNrZWROb2Rlcw0KICAgIH0sDQogICAgLy8g6KGo5Y2V5o+Q5LqkDQogICAgaGFuZGxlQWRkIChvYmplY3QpIHsNCiAgICAgIC8vIOivu+WPluWujOaVtOiKgueCuQ0KICAgICAgY29uc3QgY3VyUGVybWlzc2lvbnMgPSBuZXcgU2V0KCkNCiAgICAgIC8vIGZ1bmN0aW9uIHBhcnNlKG5vZGVzLCBzZWxlY3RlZElkKSB7DQogICAgICAvLyAgIGZvciAoY29uc3QgaXQgb2Ygbm9kZXMpIHsNCiAgICAgIC8vICAgICBsZXQgaXNGaW5kID0gZmFsc2UNCiAgICAgIC8vICAgICBpZiAoaXQuY2hpbGRzICE9PSB1bmRlZmluZWQpIHsNCiAgICAgIC8vICAgICAgIGlzRmluZCA9IHBhcnNlKGl0LmNoaWxkcywgc2VsZWN0ZWRJZCkNCiAgICAgIC8vICAgICB9DQogICAgICAvLyAgICAgaWYgKGl0LnBvaW50cyAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAvLyAgICAgICBpc0ZpbmQgPSBwYXJzZShpdC5wb2ludHMsIHNlbGVjdGVkSWQpDQogICAgICAvLyAgICAgfQ0KICAgICAgLy8gICAgIGlmIChpdC5pZCA9PT0gc2VsZWN0ZWRJZCkgew0KICAgICAgLy8gICAgICAgaXNGaW5kID0gdHJ1ZQ0KICAgICAgLy8gICAgIH0NCiAgICAgIC8vICAgICBpZiAoaXNGaW5kKSB7DQogICAgICAvLyAgICAgICBjdXJQZXJtaXNzaW9ucy5hZGQoaXQuaWQpDQogICAgICAvLyAgICAgICByZXR1cm4gdHJ1ZQ0KICAgICAgLy8gICAgIH0NCiAgICAgIC8vICAgfQ0KICAgICAgLy8gICByZXR1cm4gZmFsc2UNCiAgICAgIC8vIH0NCiAgICAgIC8vIOW3sumAieS4reeahOaOp+S7tuiKgueCuQ0KICAgICAgaWYgKHRoaXMudHJlZUNoZWNrZWROb2Rlcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgdGhpcy50cmVlQ2hlY2tlZE5vZGVzID0gdGhpcy4kcmVmcy50cmVlTWVudS5nZXRDaGVja2VkTm9kZXMoKQ0KICAgICAgICBpZiAodGhpcy50cmVlQ2hlY2tlZE5vZGVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgIHJldHVybg0KICAgICAgICB9DQogICAgICB9DQogICAgICAvLyDor7vlj5YNCiAgICAgIGZvciAoY29uc3QgaXQgb2YgdGhpcy50cmVlQ2hlY2tlZE5vZGVzKSB7DQogICAgICAgIC8vIHBhcnNlKHRoaXMuUGVybWlzc2lvbkdyb3Vwc21lbnUsIGl0LmlkKQ0KICAgICAgICBjdXJQZXJtaXNzaW9ucy5hZGQoaXQuaWQpDQogICAgICB9DQogICAgICB0aGlzLmN1clBlcm1pc3Npb25zID0gQXJyYXkuZnJvbShjdXJQZXJtaXNzaW9ucykNCiAgICAgIC8vIOS/neWtmA0KICAgICAgaWYgKHRoaXMuY3VyUGVybWlzc2lvbnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwNCiAgICAgICAgICBtZXNzYWdlOiAn6K+36YCJ5oup6ZyA6KaB55qE5p2D6ZmQ5Y+K6aG16Z2i5p2D6ZmQ54K5JywNCiAgICAgICAgICB0eXBlOiAnZXJyb3InDQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmRhdGFGb3JtU3ViKHRoaXMuY3VyUGVybWlzc2lvbnMpDQogICAgICB9DQogICAgfSwNCiAgICBub2RlRGF0ZSAobm9kZXNQYXRoLCBjdXJQZXJtaXNzaW9ucywgZmluZElkKSB7DQogICAgICBub2Rlc1BhdGgubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgew0KICAgICAgICBpZiAoY3VyUGVybWlzc2lvbnMuaW5kZXhPZihpdGVtLmlkKSA9PT0gLTEpIHsNCiAgICAgICAgICBjdXJQZXJtaXNzaW9ucy5wdXNoKGZpbmRJZCkNCiAgICAgICAgfQ0KICAgICAgfSkNCiAgICB9LA0KICAgIGRhdGFGb3JtU3ViIChjdXJQZXJtaXMpIHsNCiAgICAgIHRoaXMuJHJlZnMuZGF0YUZvcm0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLiRlbWl0KCdoYW5kbGVDbG9zZU1vZGFsJykNCiAgICAgICAgICBpZiAoX3RoaXMuZm9ybUJhc2UuaWQpIHsNCiAgICAgICAgICAgIGNvbnN0IHRlY2hub2xvZ3lUeXBlcyA9IFtdDQogICAgICAgICAgICB2YXIgZGF0YSA9IHsNCiAgICAgICAgICAgICAgaWQ6IHRoaXMuZm9ybUJhc2UuaWQsDQogICAgICAgICAgICAgIHRpdGxlOiB0aGlzLmZvcm1CYXNlLnRpdGxlLA0KICAgICAgICAgICAgICBwZXJtaXNzaW9uczogY3VyUGVybWlzDQogICAgICAgICAgICB9DQogICAgICAgICAgICB1cGRhdGUoZGF0YSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ25ld0RhdGFlcycsIHRoaXMuZm9ybUJhc2UpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhZGQoew0KICAgICAgICAgICAgICB0aXRsZTogdGhpcy5mb3JtQmFzZS50aXRsZSwNCiAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IGN1clBlcm1pcw0KICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ25ld0RhdGFlcycsIHRoaXMuZm9ybUJhc2UpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCcq5Y+35Li65b+F5aGr6aG5IScpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICAvLyDmjILovb3nu5PmnZ8NCg0KICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7fSwNCiAgLy8g5Yib5bu65a6M5q+V54q25oCBDQogIGNyZWF0ZWQgKCkgew0KICAgIF90aGlzID0gdGhpcw0KICAgIHRoaXMuc2V0dXBEYXRhKCkNCiAgfSwNCiAgLy8g57uE5Lu25pu05pawDQogIHVwZGF0ZWQ6IGZ1bmN0aW9uICgpIHt9DQp9DQo="},{"version":3,"sources":["permissions-add.vue"],"names":[],"mappings":";AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"permissions-add.vue","sourceRoot":"src/module-manage/components","sourcesContent":["<template>\r\n  <div class=\"add-form\">\r\n    <el-dialog :title=\"text+pageTitle\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form\r\n        :rules=\"ruleInline\"\r\n        ref=\"dataForm\"\r\n        :model=\"formBase\"\r\n        label-position=\"left\"\r\n        label-width=\"120px\"\r\n        style=\"width: 400px; margin-left:120px;\"\r\n      >\r\n        <el-form-item :label=\"$t('table.username')\" prop=\"title\">\r\n          <el-input v-model=\"formBase.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item :label=\"$t('table.powerDistriB')\">\r\n          <el-tree\r\n            ref=\"treeMenu\"\r\n            :data=\"treeData\"\r\n            show-checkbox\r\n            node-key=\"id\"\r\n            :default-expanded-keys=\"[0]\"\r\n            :default-checked-keys=\"formBase.permissions\"\r\n            :props=\"defaultProps\"\r\n            @check=\"handleCheckChange\"\r\n          ></el-tree>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"handleClose\">{{$t('table.cancel')}}</el-button>\r\n        <el-button type=\"primary\" @click=\"handleAdd('formBase')\">{{$t('table.confirm')}}</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { detail, update, add } from '@/api/base/permissions'\r\nimport { list } from '@/api/base/menus.js'\r\nlet _this = []\r\nexport default {\r\n  name: 'usersAdd',\r\n  props: ['text', 'pageTitle', 'ruleInline'],\r\n  data () {\r\n    return {\r\n      dialogFormVisible: false,\r\n      PermissionGroupsmenu: [],\r\n      defaultProps: {\r\n        label: 'title'\r\n      },\r\n      permissions: [],\r\n      treeCheckedNodes: [],\r\n      formBase: {\r\n        id: 0,\r\n        create_date: '',\r\n        title: '',\r\n        permissions: []\r\n      },\r\n      curPermissions: []\r\n    }\r\n  },\r\n  computed: {\r\n    treeData () {\r\n      function createNode (item) {\r\n        // 复选框选择\r\n        let checked = false\r\n        let selected = false\r\n        if (_this !== null && _this.formBase.permissions.length > 0) {\r\n          const per = _this.formBase.permissions.find(function (value, index) {\r\n            return value === item.id\r\n          })\r\n          selected = !!per\r\n        }\r\n        // 标记勾选\r\n        if (selected) {\r\n          const isPoint = item.childs === undefined && item.points === undefined\r\n          const hasChilds = item.childs !== undefined && item.childs.length > 0\r\n          const hasPoints = item.points !== undefined && item.points.length > 0\r\n          if (isPoint) {\r\n            checked = true\r\n          } else if (hasPoints) {\r\n            checked = false\r\n          } else if (hasChilds) {\r\n            checked = false\r\n          } else {\r\n            checked = true\r\n          }\r\n        }\r\n        return {\r\n          id: item.id === undefined ? 0 : item.id,\r\n          title: item.title,\r\n          children: [],\r\n          selected: selected,\r\n          checked: checked\r\n        }\r\n      }\r\n      function parseNodes (nodes, parentNode) {\r\n        for (const it of nodes) {\r\n          const node = createNode(it)\r\n          // 标记选中\r\n          // console.log(node.checked)\r\n          if (node.checked) {\r\n            parentNode.selected = true\r\n          }\r\n          if (it.childs !== undefined && it.childs.length > 0) {\r\n            parseNodes(it.childs, node)\r\n          } else if (it.points !== undefined && it.points.length > 0) {\r\n            parseNodes(it.points, node)\r\n          }\r\n          parentNode.children.push(node)\r\n        }\r\n      }\r\n      const nodes = createNode({ title: '系统菜单和页面权限点', expand: true })\r\n      parseNodes(this.PermissionGroupsmenu, nodes)\r\n      return [nodes]\r\n    }\r\n  },\r\n  methods: {\r\n    // 弹层显示\r\n    dialogFormV () {\r\n      this.dialogFormVisible = true\r\n    },\r\n    // 弹层隐藏\r\n    dialogFormH () {\r\n      this.dialogFormVisible = false\r\n    },\r\n    // 退出\r\n    handleClose () {\r\n      this.$emit('handleCloseModal')\r\n    },\r\n    // 表单重置\r\n    handleResetForm () {\r\n      this.formBase = {\r\n        id: 0,\r\n        title: '',\r\n        permissions: []\r\n      }\r\n    },\r\n    // 编辑详情数据加载\r\n    hanldeEditForm (objeditId) {\r\n      this.formBase.id = objeditId\r\n      var data = {\r\n        id: objeditId\r\n      }\r\n      detail(data).then((ret, err) => {\r\n        if (err) {\r\n          return err\r\n        }\r\n        this.formBase.id = ret.data.id\r\n        this.formBase.title = ret.data.title\r\n        this.formBase.permissions = ret.data.permissions\r\n      })\r\n    },\r\n    setupData () {\r\n      list().then(data => {\r\n        this.PermissionGroupsmenu = data.data\r\n      })\r\n    },\r\n\r\n    // 节点复选框被选中\r\n    handleCheckChange (data, checked, indeterminate) {\r\n      this.treeCheckedNodes = checked.checkedNodes\r\n    },\r\n    // 表单提交\r\n    handleAdd (object) {\r\n      // 读取完整节点\r\n      const curPermissions = new Set()\r\n      // function parse(nodes, selectedId) {\r\n      //   for (const it of nodes) {\r\n      //     let isFind = false\r\n      //     if (it.childs !== undefined) {\r\n      //       isFind = parse(it.childs, selectedId)\r\n      //     }\r\n      //     if (it.points !== undefined) {\r\n      //       isFind = parse(it.points, selectedId)\r\n      //     }\r\n      //     if (it.id === selectedId) {\r\n      //       isFind = true\r\n      //     }\r\n      //     if (isFind) {\r\n      //       curPermissions.add(it.id)\r\n      //       return true\r\n      //     }\r\n      //   }\r\n      //   return false\r\n      // }\r\n      // 已选中的控件节点\r\n      if (this.treeCheckedNodes.length === 0) {\r\n        this.treeCheckedNodes = this.$refs.treeMenu.getCheckedNodes()\r\n        if (this.treeCheckedNodes.length === 0) {\r\n          return\r\n        }\r\n      }\r\n      // 读取\r\n      for (const it of this.treeCheckedNodes) {\r\n        // parse(this.PermissionGroupsmenu, it.id)\r\n        curPermissions.add(it.id)\r\n      }\r\n      this.curPermissions = Array.from(curPermissions)\r\n      // 保存\r\n      if (this.curPermissions.length === 0) {\r\n        this.$message({\r\n          showClose: true,\r\n          message: '请选择需要的权限及页面权限点',\r\n          type: 'error'\r\n        })\r\n      } else {\r\n        this.dataFormSub(this.curPermissions)\r\n      }\r\n    },\r\n    nodeDate (nodesPath, curPermissions, findId) {\r\n      nodesPath.map(function (item, index) {\r\n        if (curPermissions.indexOf(item.id) === -1) {\r\n          curPermissions.push(findId)\r\n        }\r\n      })\r\n    },\r\n    dataFormSub (curPermis) {\r\n      this.$refs.dataForm.validate(valid => {\r\n        if (valid) {\r\n          this.$emit('handleCloseModal')\r\n          if (_this.formBase.id) {\r\n            const technologyTypes = []\r\n            var data = {\r\n              id: this.formBase.id,\r\n              title: this.formBase.title,\r\n              permissions: curPermis\r\n            }\r\n            update(data).then(() => {\r\n              this.$emit('newDataes', this.formBase)\r\n            })\r\n          } else {\r\n            add({\r\n              title: this.formBase.title,\r\n              permissions: curPermis\r\n            }).then(() => {\r\n              this.$emit('newDataes', this.formBase)\r\n            })\r\n          }\r\n        } else {\r\n          this.$Message.error('*号为必填项!')\r\n        }\r\n      })\r\n    }\r\n  },\r\n  // 挂载结束\r\n\r\n  mounted: function () {},\r\n  // 创建完毕状态\r\n  created () {\r\n    _this = this\r\n    this.setupData()\r\n  },\r\n  // 组件更新\r\n  updated: function () {}\r\n}\r\n</script>\r\n<style>\r\n.el-tree {\r\n  margin-top: 8px;\r\n}\r\n.el-tree-node__content {\r\n  height: auto;\r\n}\r\n.el-form--label-left .el-form-item__label {\r\n  text-align: right;\r\n}\r\n.el-dialog__footer {\r\n  text-align: right;\r\n}\r\n</style>\r\n"]}]}